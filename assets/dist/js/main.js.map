{"version":3,"sources":["../../src/js/main.js"],"names":["produtoresLayerToControl","L","featureGroup","feirasLayerToControl","comercioLayerToControl","produtoresLayer","layerGroup","feirasLayer","comercioLayer","MarkerIcon","Icon","extend","options","shadowUrl","iconSize","iconAnchor","popupAnchor","comerciosTotal","feirasTotal","produtoresTotal","comercioMarker","iconUrl","feiraMarker","produtorMarker","comercioMarkerSelected","feiraMarkerSelected","produtorMarkerSelected","iconMarkers","mapboxUrl","accessToken","attrib","streetsLayer","TileLayer","attribution","id","label","satelliteStreetLayer","map","center","zoom","minZoom","maxZoom","zoomControl","closePopupOnClick","attributionControl","on","e","Control","zoomHome","addTo","streetsMinimapLayer","miniMapOptions","position","toggleDisplay","width","height","strings","hideText","showText","MiniMap","basemapsOptions","basemaps","tileX","tileY","tileZ","control","latLngOptions","separator","emptyString","mousePosition","scaleOptions","metric","imperial","scale","northWest","latLng","southEast","bounds","latLngBounds","setMaxBounds","$","getJSON","geoJsonLayer","geoJson","data","pointToLayer","feature","latlng","marker","icon","properties","current_tipo","title","nome","onEachFeature","bindPopup","document","getElementById","innerHTML","markersCluster","layer","description","mouseover","setIcon","mouseout","addLayerByType","markerClusterGroup","disableClusteringAtZoom","showCoverageOnHover","spiderfyOnMaxZoom","addLayer","sycronizeListMarkers","linePoint","markerNames","sortList","markerName","append","updateEventsOnMarkers","click","currentTarget","text","moveToPoint","hover","eachLayer","layerName","stringLayerName","addRemoveLayerOfCluster","isToAdd","removeLayer","is","keyup","searchField","val","regex","RegExp","listSearch","propertiesFound","search","length","push","sort","forEach","element","index","inputValue","trim","layerToSearch","name","controle","geometry","coordinates","flyTo","openPopUp","desc","openPopup","arrayTemp","layerToSort"],"mappings":"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","file":"main.js","sourcesContent":["/*\r\n\tAutor: Ricardo Barbosa\r\n\tEmail: ricardobcm@outlook.com\r\n*/\r\nlet //Layers para controlar a inserção/remoção dos layers no cluster\r\nprodutoresLayerToControl = L.featureGroup(),\r\nfeirasLayerToControl = L.featureGroup(),\r\ncomercioLayerToControl = L.featureGroup(),\r\nprodutoresLayer = L.layerGroup(),\r\nfeirasLayer = L.layerGroup(),\r\ncomercioLayer = L.layerGroup(),\r\n\r\n//Icones para os marcadores\r\nMarkerIcon = L.Icon.extend({\r\n\toptions: {\r\n\t\tshadowUrl: 'assets/images/shadow.png',\r\n\t\ticonSize: [54, 71],\r\n\t\ticonAnchor: [29, 63],\r\n\t\tpopupAnchor: [-2, -61]\r\n\t}\r\n}),\r\n\r\n// Contadores\r\ncomerciosTotal = 0,\r\nfeirasTotal = 0,\r\nprodutoresTotal = 0;\r\n\r\nconst\r\ncomercioMarker = new MarkerIcon({ iconUrl: 'assets/images/comercio-marker.png' }),\r\nfeiraMarker = new MarkerIcon({ iconUrl: 'assets/images/feira-marker.png' }),\r\nprodutorMarker = new MarkerIcon({ iconUrl: 'assets/images/produtor-marker.png' }),\r\ncomercioMarkerSelected =  new MarkerIcon({ iconUrl: 'assets/images/comercio-marker-selected.png' }),\r\nfeiraMarkerSelected = new MarkerIcon({ iconUrl: 'assets/images/feira-marker-selected.png' }),\r\nprodutorMarkerSelected = new MarkerIcon({ iconUrl: 'assets/images/produtor-marker-selected.png' }),\r\n\r\niconMarkers = {\r\n\t'Comercio': comercioMarker,\r\n\t'Feira': feiraMarker,\r\n\t'Produtor': produtorMarker,\r\n\t'ComercioSelected': comercioMarkerSelected,\r\n\t'FeiraSelected': feiraMarkerSelected,\r\n\t'ProdutorSelected': produtorMarkerSelected\r\n},\r\n\r\nmapboxUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\r\naccessToken = 'pk.eyJ1IjoicmljYXJkb2JjbSIsImEiOiJjajlrMTJkejQxaTUyMzNwZ3cxcnM3MDU2In0.pr0XFTVGiylyl6Sth57t9g',\r\nattrib = '<a href=\"http://openstreetmap.org\">OpenStreetMap</a> | <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a> | <a href=\"http://mapbox.com\">Mapbox</a>',\r\n// Layers\r\nstreetsLayer = new L.TileLayer( mapboxUrl, {\r\n\tattribution: attrib,\r\n\tid: 'mapbox.streets',\r\n\taccessToken: accessToken,\r\n\tlabel: 'Estradas'\r\n}),\r\nsatelliteStreetLayer = new L.TileLayer( mapboxUrl, {\r\n\tattribution: attrib,\r\n\tid: 'mapbox.streets-satellite',\r\n\taccessToken: accessToken,\r\n\tlabel: 'Satélite'\r\n}),\r\n//Adicão do mapa\r\nmap = L.map('map', {\r\n\tcenter: [-5.1026, -42.8082],\r\n\tzoom: 11,\r\n\tminZoom: 11,\r\n\tmaxZoom: 18,\r\n\tzoomControl: false,\r\n\tclosePopupOnClick: true,\r\n\tattributionControl: true\r\n});\r\n\r\nmap.on('contextmenu', e => e);\r\n\r\n// Controles\r\nL.Control.zoomHome().addTo( map );\r\n\r\nlet //Minimapa\r\nstreetsMinimapLayer = new L.TileLayer( mapboxUrl, {\r\n\tattribution: attrib,\r\n\tid: 'mapbox.streets',\r\n\tminZoom: 7,\r\n\tmaxZoom: 13,\r\n\taccessToken: accessToken\r\n}),\r\nminiMapOptions = {\r\n\tposition: 'topright',\r\n\ttoggleDisplay: true,\r\n\twidth : 120,\r\n\theight : 120,\r\n\tstrings: {\r\n\t\thideText: 'Esconder minimapa',\r\n\t\tshowText: 'Exibir minimapa'\r\n\t}\r\n};\r\nnew L.Control.MiniMap( streetsMinimapLayer, miniMapOptions ).addTo( map );\r\n\r\nlet // Basemaps Switch\r\nbasemapsOptions = {\r\n\tbasemaps: [streetsLayer, satelliteStreetLayer],\r\n\ttileX: 0,\r\n\ttileY: 0,\r\n\ttileZ: 1\r\n};\r\nL.control.basemaps( basemapsOptions ).addTo( map );\r\n\r\nlet\r\nlatLngOptions = {\r\n\tseparator: ' [] ',\r\n\temptyString: 'Latitude [] Longitude'\r\n};\r\nL.control.mousePosition( latLngOptions ).addTo( map );\r\n\r\nlet\r\nscaleOptions = {\r\n\tmetric: true,\r\n\timperial: false\r\n};\r\nL.control.scale( scaleOptions ).addTo( map );\r\n\r\nlet //Cerca geográfica de visualizãção\r\nnorthWest = L.latLng( -4.904886794837085, -43.18674087524414 ),\r\nsouthEast = L.latLng( -5.332669664718695, -42.37615585327149 ),\r\nbounds = L.latLngBounds( northWest, southEast );\r\nmap.setMaxBounds( bounds );\r\n\r\n$.getJSON('data.geojson', data => {\r\n\tlet geoJsonLayer = L.geoJson( data, {\r\n\t\tpointToLayer: ( feature, latlng ) => {\r\n\t\t\treturn L.marker( latlng, {icon: iconMarkers[feature.properties.current_tipo], title: feature.properties.nome} );\r\n\t\t},\r\n\t\tonEachFeature: bindPopup\r\n\t});\r\n\r\n\tdocument.getElementById('totalComercios').innerHTML = `(${comerciosTotal})`;\r\n\tdocument.getElementById('totalFeiras').innerHTML = `(${feirasTotal})`;\r\n\tdocument.getElementById('totalProdutores').innerHTML = `(${produtoresTotal})`;\r\n\tprodutoresLayerToControl.addTo( map );\r\n\tfeirasLayerToControl.addTo( map );\r\n\tcomercioLayerToControl.addTo( map );\r\n\tmarkersCluster.addTo( map );\r\n});\r\n\r\nconst bindPopup = ( feature, layer ) => {\r\n\tlet\r\n\tproperties = feature.properties,\r\n\tdescription = '';\r\n\tfeature.layer = layer;\r\n\r\n\tdescription = `<div><strong> ${properties.nome} </strong></div>`;\r\n\tlayer.bindPopup( description );\r\n\tlayer.on({\r\n\t\tmouseover : () => layer.setIcon(iconMarkers[`${properties.current_tipo}Selected`]),\r\n\t\tmouseout : () => layer.setIcon(iconMarkers[properties.current_tipo])\r\n\t});\r\n\r\n\taddLayerByType[properties.current_tipo]( layer );\r\n},\r\n//Agrupador de marcadores\r\nmarkersCluster = L.markerClusterGroup({\r\n\tdisableClusteringAtZoom: 13,\r\n\tshowCoverageOnHover: true,\r\n\tspiderfyOnMaxZoom: false\r\n});\r\n\r\nconst addLayerByType = {\r\n\t'Comercio': layer => {\r\n\t\tcomercioLayer.addLayer( layer );\r\n\t\tcomerciosTotal++;\r\n\t},\r\n\t'Feira': layer => {\r\n\t\tfeirasLayer.addLayer( layer );\r\n\t\tfeirasTotal++;\r\n\t},\r\n\t'Produtor': layer => {\r\n\t\tprodutoresLayer.addLayer( layer );\r\n\t\tprodutoresTotal++;\r\n\t}\r\n};\r\n\r\nconst sycronizeListMarkers = () => {\r\n\tlet\r\n\tlinePoint = '',\r\n\tmarkerNames = sortList(markersCluster);\r\n\tdocument.getElementById('list-markers').innerHTML = '';\r\n\r\n\tfor ( let markerName of markerNames ) {\r\n\t\tlinePoint += `<li class=\"list-group-item list-group-item-action\">${markerName}</li>`;\r\n\t}\r\n\t$('#list-markers').append( linePoint );\r\n\tupdateEventsOnMarkers();\r\n};\r\n\r\nconst updateEventsOnMarkers = () => {\r\n\tlet \r\n\tnome = null,\r\n\ticon = null;\r\n\r\n\t$('#list-markers li').click( e => {\r\n\t\tnome = $(e.currentTarget).text();\r\n\t\tmoveToPoint( markersCluster, nome );\r\n\t});\r\n\r\n\t$('#list-markers li').hover( e => {\r\n\t\tnome = $(e.currentTarget).text();\r\n\t\tmarkersCluster.eachLayer( layer => {\r\n\t\t\tif ( layer.feature.properties.nome === nome ) {\r\n\t\t\t\tlayer.setIcon(iconMarkers[`${layer.feature.properties.current_tipo}Selected`]);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t() => {\r\n\t\tmarkersCluster.eachLayer( layer => {\r\n\t\t\tif ( layer.feature.properties.nome === nome ) {\r\n\t\t\t\tlayer.setIcon(iconMarkers[layer.feature.properties.current_tipo]);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n};\r\n\r\nmap.on('layeradd ', e => {\r\n\tlet layerName = stringLayerName(e.layer);\r\n\tlayerName ? addRemoveLayerOfCluster[layerName]( true ) : null\r\n});\r\n\r\nmap.on('layerremove', e => {\r\n\tlet layerName = stringLayerName(e.layer);\r\n\tlayerName ? addRemoveLayerOfCluster[layerName]( false ) : null\r\n});\r\n\r\nconst addRemoveLayerOfCluster = {\r\n\tcomercioLayerToControl: isToAdd => {\r\n\t\tisToAdd ? markersCluster.addLayer( comercioLayer ) : markersCluster.removeLayer( comercioLayer );\r\n\t\tsycronizeListMarkers();\r\n\t},\r\n\tfeirasLayerToControl: isToAdd => {\r\n\t\tisToAdd ? markersCluster.addLayer( feirasLayer ) : markersCluster.removeLayer( feirasLayer );\r\n\t\tsycronizeListMarkers();\r\n\t},\r\n\tprodutoresLayerToControl: isToAdd => {\r\n\t\tisToAdd ? markersCluster.addLayer( produtoresLayer ) : markersCluster.removeLayer( produtoresLayer );\r\n\t\tsycronizeListMarkers();\r\n\t}\r\n};\r\n\r\nconst stringLayerName = layer =>\r\n\tlayer === comercioLayerToControl ? 'comercioLayerToControl' :\r\n\tlayer === feirasLayerToControl ? 'feirasLayerToControl' : \r\n\tlayer === produtoresLayerToControl ? 'produtoresLayerToControl' : ''\r\n\r\n$('#switch-produtor').on('change', e => $(e.currentTarget).is(':checked') ? map.addLayer( produtoresLayerToControl ) : map.removeLayer( produtoresLayerToControl ));\r\n$('#switch-comercio').on('change', e => $(e.currentTarget).is(':checked') ? map.addLayer( comercioLayerToControl ) : map.removeLayer( comercioLayerToControl ));\r\n$('#switch-feira').on('change', e => $(e.currentTarget).is(':checked') ? map.addLayer( feirasLayerToControl ) : map.removeLayer( feirasLayerToControl ));\r\n\r\n// Busca em tempo real (Ajax search)\r\n$('#search-input').keyup( () => {\r\n\tlet\r\n\tsearchField = $('#search-input').val(),\r\n\tregex = new RegExp( searchField, \"i\" ),\r\n\tlistSearch = '',\r\n\tpropertiesFound = [];\r\n\tif ( !searchField ) {\r\n\t\tdocument.getElementById('search-results').innerHTML = '';\r\n\t} else {\r\n\t\tmarkersCluster.eachLayer( layer => {\r\n\t\t\tif ( layer.feature.properties.nome.search(regex) != -1 && searchField && propertiesFound.length < 5 ){\r\n\t\t\t\tpropertiesFound.push(layer.feature.properties.nome);\r\n\t\t\t}\r\n\t\t});\r\n\t\tpropertiesFound.sort();\r\n\t\tpropertiesFound.forEach( function(element, index) {\r\n\t\t\tlistSearch += `<li class=\"list-group-item link-class\"> ${element} </li>`;\r\n\t\t});\r\n\t\tdocument.getElementById('search-results').innerHTML = listSearch;\r\n\t\tpropertiesFound.length = 0;\r\n\t}\r\n});\r\n\r\n$('#search-results').on('click', 'li', e => {\r\n\tlet inputValue = $(e.currentTarget).text().trim();\r\n\t$('#search-input').val( inputValue );\r\n\tmoveToPoint( markersCluster, inputValue );\r\n\tdocument.getElementById('search-results').innerHTML = '';\r\n});\r\n\r\nconst moveToPoint = ( layerToSearch, name ) => {\r\n\tlet \r\n\tcontrole = true,// Variável evita mais de uma chamada ao 'zoomend' por vez \r\n\tlatlng;\r\n\tlayerToSearch.eachLayer( layer => {\r\n\t\tif ( layer.feature.properties.nome === name ){\r\n\t\t\tlatlng = L.latLng( layer.feature.geometry.coordinates[1], layer.feature.geometry.coordinates[0] );\r\n\t\t\tmap.flyTo( latlng,14 );\r\n\t\t\tmap.on('zoomend', () => {\r\n\t\t\t\tif ( controle ) {\r\n\t\t\t\t\topenPopUp( name ); \r\n\t\t\t\t\tcontrole = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n};\r\n\r\nconst openPopUp = name => {\r\n\tlet desc = '';\r\n\tmarkersCluster.eachLayer( layer => {\r\n\t\tif ( layer.feature.properties.nome === name ){\r\n\t\t\tdesc = '<div><strong>' + name + '</strong><br/><br/></div>';\r\n\t\t\tlayer.bindPopup( desc ).openPopup();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nconst sortList = layerToSort => {\r\n\tlet arrayTemp = [];\r\n\tlayerToSort.eachLayer( layer => {\r\n\t\tarrayTemp.push( layer.feature.properties.nome );\r\n\t});\r\n\treturn arrayTemp.sort();\r\n};\r\n"]}